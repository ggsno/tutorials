# CSS 성능

- CSS 애니메이션에서 성능에 영향을 많이 미치는 것 -> reflow, repaint

## reflow와 repaint

### reflow

- 생성된 DOM 노드의 레이아웃(너비, 높이 등) 변경 시 영향받는 모든 노드의 수치를 다시 계산하여 렌더 트리를 재생성하는 작업

### repaint

- reflow 과정이 끝난 후 재생성된 렌더 트리를 다시 그리는 작업.
- 수치와 상관 없는 background-color, visibility, outline 등의 스타일 변경시 reflow과정이 생략된 repaint 작업만 수행
  
### reflow 최소화
1. 클래스 변화에 따른 스타일 변화를 원할 경우, 최대한 DOM 구조 상 끝단에 위치한 노드에 추가
   - 클래스가 변화할 때 reflow가 일어나는 것을 막을 순 없지만 성능 문제를 최소화 가능
2. 애니메이션에 들어간 엘리먼트는 가급적 position:fixed 혹은 position:ansolute로 지정
   - 가급적 사용하지 않는 것을 권장하나, 불가피하다면 다른 요소에 영향을 끼치지 않고 해당 요소에만 reflow가 발생하게끔 유도
3. js를 통해 스타일 변화를 줄 경우, 가급적 한 번에 처리
4. 인라인 스타일 최대한 배제
5. 테이블 레이아웃 지양
   - 테이블 값에 따라 넓이를 계산하므로 렌더링이 느려짐
   - 불가피하다면 CSS속성 table-layout:fixed를 사용하면 조금 더 빠름
6. CSS 하위선택자는 꼭 필요한 만큼만 사용
   - 불필요한 하위 선택자는 reflow가 유발하는 CSS recalculation에 의해 성능 저하 유발
7. will-change
  

## will-change

- 변화가 예상되는 요소를 브라우저에게 미리 알려주어 성능 향상 도모
- 값 :
  - auto : 기본값. 별다른 최적화를 실시하지 않음
  - scroll-postion : 
    - 스크롤 할 때 엘리먼트 위치가 변경될 것을 알려줌
    - 설정 시 브라우저는 스크롤 가능한 요소를 미리 최적화하여 렌더링
    - 한 번에 많은 양을 스크롤하거나 빠른 스크롤이 필요할 경우 사용
  - contents : 요소의 컨텐츠 변경을 알려줌
  - <custom-ident> : 변경하고 싶은 속성 사용
- will-change 속성이 사용된 요소는 최적화를 하기 위해 많은 자원을 소모하기 때문에 과용하지 말 것
참고 : https://wit.nts-corp.com/2017/06/05/4571